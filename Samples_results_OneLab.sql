SELECT 
    ID,
    PARENT_IDENTITY,
    VALUE_KEY,
    VALUE_NUMERIC,
    VALUE_NUMERIC_TEXT,
    VALUE_TYPE,
    INTERPRETATION,
    LAST_UPDATED
FROM COR_PARAMETER_VALUE
WHERE (
    -- Looking for 41.02 (allowing for slight rounding)
    VALUE_NUMERIC BETWEEN 41.0 AND 41.1
    OR VALUE_NUMERIC_TEXT LIKE '41.02%'
    OR VALUE_NUMERIC_TEXT = '41.02'
    OR VALUE_STRING LIKE '41.02%'
) OR (
    -- Looking for 42.51 (allowing for slight rounding)
    VALUE_NUMERIC BETWEEN 42.5 AND 42.6
    OR VALUE_NUMERIC_TEXT LIKE '42.51%'
    OR VALUE_NUMERIC_TEXT = '42.51'
    OR VALUE_STRING LIKE '42.51%'
)
ORDER BY VALUE_NUMERIC, LAST_UPDATED DESC;

PROMPT === STEP 3: Can we join samples to their results? ===
SELECT 
    s.SAMPLE_ID,
    s.ID as SAMPLE_RAW_ID,
    s.NAME as SAMPLE_NAME,
    ms.ID as MEASUREMENTSAMPLE_ID,
    m.ID as MEASUREMENT_ID,
    m.RECORD_NAME,
    m.DATE_CREATED,
    pv.ID as PARAM_VALUE_ID,
    pv.VALUE_KEY,
    pv.VALUE_NUMERIC,
    pv.VALUE_NUMERIC_TEXT,
    pv.INTERPRETATION,
    pv.VALUE_STRING
FROM SAM_SAMPLE s
JOIN RES_MEASUREMENTSAMPLE ms ON s.ID = ms.MAPPED_SAMPLE_ID
JOIN RES_MEASUREMENT m ON ms.MEASUREMENT_ID = m.ID
JOIN COR_PARAMETER_VALUE pv ON pv.PARENT_IDENTITY = m.ID
WHERE s.SAMPLE_ID IN ('S000200', 'S000199')
  AND (
    (pv.VALUE_NUMERIC BETWEEN 41.0 AND 41.1)
    OR (pv.VALUE_NUMERIC BETWEEN 42.5 AND 42.6)
    OR pv.VALUE_NUMERIC_TEXT IN ('41.02', '42.51')
    OR pv.VALUE_NUMERIC_TEXT LIKE '41.02%'
    OR pv.VALUE_NUMERIC_TEXT LIKE '42.51%'
  )
ORDER BY s.SAMPLE_ID, pv.VALUE_NUMERIC;